{% extends "Shared/_layout.twig" %}

{% block title %} Transactions {% endblock %}

{% block header_scripts %}
    <link href="/assets/components/toastr/toastr.min.css"  rel="stylesheet">
 {% endblock %}

{% block body %}
    
<!-- side nav menu -->
{% include '/Bookkeeping/_sidenav.twig' %}

<!-- page content -->
<div class="container-fluid" id="vehiclelogbook" v-cloak>
    
    <!-- csrf protection -->
    <input type="hidden" name="csrf" id="csrf" value="{{ csrf }}">

    <div class="row border-bottom pt-4">
        <div class="col-10">
            <h1 class="text-dark mb-2">Vehicle Log Book</h1>   
        </div>
        <!-- date selection -->
        <div class="col-2">        
            <div class="input-group">                                       
                <input type="date" class="form-control" placeholder="date yyyy-mm-dd" aria-label="Start date" aria-describedby="button-addon4" v-model="booklog_date" v-on:change="onYearChange()">                   
            </div>               
        </div>           
    </div>        
 

    <!-- vehicle odometer reading for selected year -->
    <div class="row">
         <div class="col-12">         
            <h3 class="mt-5">
                Odometer Readings             
                <a href="#" v-on:click.prevent="odometerDelOne()" v-if="odometer != false">
                    <i class="far fa-trash-alt btn-sm text-danger align-middle"
                        data-toggle="tooltip" data-placement="top" title="remove Odometer"></i>
                </a>                                 
            </h3>
        </div>
        <!-- alert in case there is no odometer reading for a selected year -->
        <div class="col-8 alert alert-warning ml-3" role="alert" v-if="odometer == false">
            <i class="fas fa-exclamation-triangle mr-2"></i>
            Sorry but there is no odometer reading for the selected year.
        </div>

        <div class="col-12" v-if="odometer == false">
            <form class="form-inline">
                <div class="form-group mr-1 col-3 pr-0 pl-0">
                    <label for="txt_vehicle" class="sr-only">Vehicle used</label>
                    <input type="text" class="form-control col-12" id="txt_vehicle" placeholder="Vehicle" v-model="new_odometer.vehicle_desc">
                </div>
                <div class="form-group mr-1">
                    <label for="start_odometer" class="sr-only">Start Odometer</label>
                    <input type="text" class="form-control" id="txt_start_odometer" placeholder="Year start odometer" v-model="new_odometer.year_start_odometer">
                </div>
                <div class="form-group mr-1">
                    <label for="end_odometer" class="sr-only">End Odometer</label>
                    <input type="text" class="form-control" id="txt_end_odometer" placeholder="Year end odometer" v-model="new_odometer.year_end_odometer">
                </div>               
              
                <button type="submit" class="btn btn-success mr-3" v-on:click.prevent="odometerAddNew()">
                    <i class="fas fa-plus mr-1"></i>
                    Add Odometer
                </button>
            </form>
        </div>

        <!-- odometer reading -->
        <div class="col-4" v-if="odometer != false">
            <ul class="list-group">
                <li class="list-group-item d-flex justify-content-between align-items-center"><strong>Year Start</strong> {{ '{{odometer.year_start_odometer}}' }} km</li>
                <li class="list-group-item d-flex justify-content-between align-items-center"><strong>Year End</strong> {{ '{{odometer.year_end_odometer}}' }} km</li>                         
            </ul>
        </div>       
        <div class="col-4" v-if="odometer != false">
            <ul class="list-group">
                <li class="list-group-item d-flex justify-content-between align-items-center"><strong>Vehicle</strong> {{ '{{odometer.vehicle_desc}}' }}</li>
                <li class="list-group-item d-flex justify-content-between align-items-center"><strong>Year</strong> {{ '{{odometer.created_at}}' }}</li>              
            </ul>
        </div>      
    </div>  

    <!-- vehicle log book miles -->
    <div class="row" v-if="odometer != false">
        <div class="col-8">
            <h3 class="mt-5">
                Miles Records
                <a href="#" v-on:click="displayForm(true)">
                    <i class="far fa-plus-square btn-sm text-success align-middle"
                        data-toggle="tooltip" data-placement="top" title="Add Miles"></i>
                </a>                 
            </h3>
            <table class="table table-bordered bg-white">
                <thead class="bg-dark text-white">
                    <tr>
                        <th scope="col">Destination/Address</th>
                        <th scope="col">Purpose</th>
                        <th scope="col">Distance</th>
                        <th scope="col">Date</th>
                        <th scope="col"></th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="item in booklogs">
                        <td>
                            {{ '{{item.destination}}' }} 
                            <p><small> at {{ '{{item.address}}' }} </small></p>
                        </td>
                        <td>{{ '{{item.purpose}}' }}</td>
                        <td>{{ '{{item.travel_distance}}' }} km</td>
                        <td>{{ '{{item.travel_date}}' }}</td>
                        <td><i class="far fa-trash-alt btn-sm text-danger align-middle" data-toggle="tooltip" data-placement="top" title="remove transaction"></i></td>
                    </tr>                                      
                </tbody>
            </table>

            <!-- pagination for vehicle log book -->
            <nav aria-label="vehicle log book pagination" v-if="booklogs_pager.length > 0">
                <ul class="pagination justify-content-end">
                    <li class="page-item disabled text-dark">
                        <a class="page-link text-dark" href="#" tabindex="-1">Previous</a>
                    </li>
                    <li class="page-item"><a class="page-link text-success" href="#">1</a></li>
                    <li class="page-item bg-dark">
                        <a class="page-link text-white bg-dark text-bold" href="#">2 <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="page-item"><a class="page-link text-success" href="#">3</a></li>
                    <li class="page-item">
                        <a class="page-link text-dark" href="#">Next</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
       
</div>




{% endblock %}

{% block custom_scripts %}

    <script src="/assets/js/vue.global.prod.js"></script>
    <script src="/assets/components/toastr/toastr.min.js"></script>

    <script src="/assets/js/vue/finances/vehiclelogbook/index.js"></script>


     <script type="application/javascript">
        $(function () {
            $('[data-toggle="tooltip"]').tooltip();
        });
    </script>

{% endblock %}